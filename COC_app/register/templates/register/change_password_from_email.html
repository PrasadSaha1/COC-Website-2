{% extends "main/base.html" %}

{% load crispy_forms_tags %}

{% block content %}
  <h1>Username Retrieval</h1>
  <p>Enter your email to retrieve your username(s)</p>

  <form method="POST" class="form-group">
    {% csrf_token %}
    {{ form|crispy }}
    <button type="submit" class="btn btn-primary">Submit</button>
  </form>

  {% if messages %}
    <div id="success-message" class="alert alert-success mt-3" style="display: none;">
      {% for message in messages %}
        <p>{{ message }}</p>
      {% endfor %}
    </div>
  {% endif %}

  <p>Remember your username? <a href="/register/login">Log in here.</a></p>
  <p>Know your username but forgot your password? Click <a href="/register/login">here</a>.</p>

  <script>
    // Show success message after form submission
    const form = document.querySelector('form');
    form.addEventListener('submit', function(event) {
      event.preventDefault();
      const successMessage = document.getElementById('success-message');
      successMessage.style.display = 'block';
      form.submit();  // Continue submitting the form after showing the message
    });
  </script>
{% endblock %}
